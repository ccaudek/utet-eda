{
  "hash": "dba52c2c6b1dc7e0848150430c0ff703",
  "result": {
    "engine": "knitr",
    "markdown": "# Principi della visualizzazione dei dati {#sec-eda-visualization}\n\n::: {.epigraph}\n> “Above all else show the data.”\n>\n> -- **Edward R. Tufte**, The Visual Display of Quantitative Information (1983)\n:::\n\n\n## Introduzione {.unnumbered .unlisted} \n\nIn questo capitolo vengono introdotti i principi fondamentali della visualizzazione dei dati, accompagnati da esempi concreti e da una discussione sui principali errori da evitare. La visualizzazione non è soltanto un supporto estetico: è uno strumento essenziale per interpretare, comunicare e validare i risultati delle analisi.\n\nUn buon grafico permette di cogliere immediatamente pattern, anomalie e bias che resterebbero nascosti in una semplice tabella di valori. Per chi desidera un approfondimento sistematico, un riferimento utile è il capitolo [Data Visualization](http://rafalab.dfci.harvard.edu/dsbook-part-1/dataviz/intro-dataviz.html) del libro *Introduction to Data Science*..\n\nL’ampia disponibilità di dataset complessi e la diffusione di strumenti software sempre più accessibili hanno reso la visualizzazione un passaggio centrale in molti ambiti scientifici e professionali: non solo facilita la comunicazione dei risultati, ma stimola nuove domande e consente di individuare rapidamente errori o anomalie.\n\n\n### Panoramica del capitolo {.unnumbered .unlisted}\n\n- Comunicare i risultati basati sui dati. \n- Utilizzare `ggplot2` per creare grafici personalizzati.  \n- Riconoscere i limiti di alcuni grafici comunemente utilizzati e comprendere perché evitarli.  \n \n\n::: {.callout-tip collapse=true}\n## Prerequisiti\n\n- Leggere [*Testing Statistical Charts: What Makes a Good Graph?* (Vanderplas, Cook, and Hofmann 2020)](https://doi.org/10.1146/annurev-statistics-031219-041252). Questo articolo descrive le migliori pratiche per la creazione di grafici.\n- Consultare il capitolo [Data visualization](https://r4ds.hadley.nz/data-visualize) di @wickham2023r. Questo capitolo fornisce una panoramica degli aspetti fondamentali della visualizzazione dei dati.\n- Consultare [Data Visualization. A practical introduction](https://socviz.co) di @healy2018data.\n- Consultare [Fundamentals of Data Visualization](https://clauswilke.com/dataviz/) di @wilke2019fundamentals.\n- Leggere il post [Open letter to journal editors: dynamite plots must die](https://simplystatistics.org/posts/2019-02-21-dynamite-plots-must-die/) di Rafael Irizarry.\n- Consultare il post [The top ten worst graphs](https://www.biostat.wisc.edu/~kbroman/topten_worstgraphs/) di Karl Broman.\n- Leggere il capitolo [Data Visualization](http://rafalab.dfci.harvard.edu/dsbook-part-1/dataviz/intro-dataviz.html) di *Introduction to Data Science*.\n- Visionare [Communicating Science Using Visuals: Tips for Scientists](https://www.simonsfoundation.org/event/2024-flatiron-wide-autumn-meeting-fwam/).\n:::\n\n::: {.callout-caution collapse=true title=\"Preparazione del Notebook\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhere::here(\"code\", \"_common.R\") |>\n  source()\n\n# Load packages\nif (!requireNamespace(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(dslabs, ggrepel, stringr)\n```\n:::\n\n:::\n\n\n## Un'immagine vale più di mille parole\n\nI numeri da soli raramente raccontano una storia chiara. Consideriamo, ad esempio, i dati sugli omicidi con armi da fuoco negli Stati Uniti. Una tabella con i valori grezzi permette di sapere, per ogni stato, popolazione e numero di omicidi. Tuttavia, osservandola è difficile farsi un’idea immediata della distribuzione: quali sono gli stati più popolosi o i meno popolosi? Qual è la dimensione “tipica” di uno stato? Esiste una relazione tra popolazione e numero totale di omicidi? E come si distribuiscono i tassi di omicidio tra le diverse regioni?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(murders)\n#>        state abb region population total\n#> 1    Alabama  AL  South    4779736   135\n#> 2     Alaska  AK   West     710231    19\n#> 3    Arizona  AZ   West    6392017   232\n#> 4   Arkansas  AR  South    2915918    93\n#> 5 California  CA   West   37253956  1257\n#> 6   Colorado  CO   West    5029196    65\n```\n:::\n\n\nUn grafico, al contrario, rende queste relazioni visibili a colpo d’occhio. Nella figura che segue, la scala logaritmica su entrambi gli assi permette di rappresentare in modo compatto sia gli stati più grandi, come California, Texas e New York, sia quelli con popolazioni molto ridotte, come Wyoming, Vermont o Alaska. Si vede subito che la maggior parte degli stati ha una popolazione compresa tra uno e dieci milioni di abitanti, mentre gli stati più popolosi si collocano nettamente a destra del grafico.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](05_data_visualization_files/figure-html/ggplot-example-plot-0-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nAllo stesso modo, la relazione tra popolazione e numero di omicidi appare chiara: più abitanti significa, in media, più omicidi. Tuttavia, si notano discrepanze: alcuni stati registrano più omicidi del previsto in rapporto alla popolazione, mentre altri ne hanno meno, segnalando l’influenza di fattori ulteriori. Anche la colorazione per regione rivela differenze interessanti: il Sud tende a registrare tassi più elevati, il Nord-Est valori relativamente bassi, l’Ovest mostra una grande variabilità, e il Midwest si colloca in posizione intermedia o bassa.\n\nIl detto “un’immagine vale più di mille parole” trova qui piena conferma: un buon grafico non solo comunica con immediatezza, ma spesso sostituisce lunghe spiegazioni numeriche, guidando lo sguardo verso i pattern più rilevanti e stimolando nuove domande di analisi.\n\n\n## Codificare i dati attraverso segnali visivi\n\nOgni visualizzazione si fonda sulla trasformazione dei dati in **segnali visivi** che il nostro sistema percettivo può elaborare con immediatezza. Gli elementi più comuni sono la posizione, la lunghezza, gli angoli, l’area, la luminosità e la tonalità del colore. Non tutti, però, hanno la stessa efficacia.\n\nIl nostro cervello è particolarmente sensibile alle differenze spaziali: per questo la **posizione** e la **lunghezza** sono i canali più potenti per trasmettere informazione quantitativa. Un grafico a barre, ad esempio, permette di confrontare valori in modo rapido e preciso proprio perché sfrutta la lunghezza come segnale visivo. Al contrario, **angoli e aree** sono molto meno intuitivi: grafici a torta o bolle possono risultare accattivanti, ma spesso portano a errori percettivi, soprattutto quando le differenze tra categorie sono ridotte.\n\nIl **colore** gioca un ruolo cruciale quando vogliamo distinguere categorie o rappresentare variabili qualitative. È un elemento indispensabile nelle visualizzazioni multidimensionali, come le heatmap, ma deve essere usato con attenzione. Alcune combinazioni, come il rosso e il verde, possono rendere il grafico illeggibile per persone con daltonismo, e in generale una palette mal progettata può distogliere l’attenzione dai contenuti principali.\n\nInfine, è importante distinguere tra strumenti di precisione e strumenti di sintesi. Le **tabelle** sono ideali quando è necessario leggere valori numerici esatti, mentre i grafici diventano insostituibili di fronte a dataset complessi, perché mettono in evidenza pattern, tendenze e anomalie che difficilmente emergerebbero da un elenco di numeri.\n\n\n## Scelta della visualizzazione più adeguata\n\nNon esiste una visualizzazione “migliore” in assoluto: la scelta dipende sempre dalla **natura dei dati** e dallo **scopo comunicativo**. Se l’obiettivo è confrontare valori quantitativi tra diverse categorie, i grafici a barre o i dot plot risultano particolarmente chiari. Quando invece vogliamo descrivere la distribuzione di una variabile continua, strumenti come l’istogramma, il boxplot o i più moderni raincloud plots permettono di cogliere rapidamente forma, variabilità e presenza di outlier. Per indagare relazioni tra due variabili continue, i grafici di dispersione offrono un’immediatezza che difficilmente può essere sostituita da altre rappresentazioni.\n\nQualunque sia il tipo di grafico scelto, rimane centrale il principio della **chiarezza**. Una visualizzazione sovraccarica di dettagli, effetti grafici o decorazioni rischia di distrarre e confondere, mentre una rappresentazione essenziale mette in risalto il messaggio principale e guida lo sguardo verso le informazioni rilevanti. In questo senso, un buon grafico non è solo corretto dal punto di vista tecnico, ma è anche uno strumento di comunicazione efficace.\n\n\n\n## Aspetti tecnici della visualizzazione\n\nUna buona visualizzazione non dipende soltanto dalla scelta del tipo di grafico, ma anche da una serie di accorgimenti tecnici che ne determinano chiarezza e correttezza percettiva. Alcune regole, spesso sottovalutate, possono fare la differenza tra un grafico informativo e uno fuorviante.\n\n\n### Inclusione dello zero\n\nQuando la lunghezza viene utilizzata come segnale visivo – come accade nei grafici a barre – l’asse deve sempre partire da zero. In caso contrario, le differenze appariranno artificialmente amplificate, inducendo interpretazioni scorrette. Nei grafici che si basano sulla posizione, come gli scatter plot, questa regola non è altrettanto stringente: qui l’inclusione dello zero dipende piuttosto dal contesto e dal significato delle variabili rappresentate.\n\n\n### Prevenire le distorsioni\n\nAlcuni grafici, come i bubble plot, rischiano di esagerare le differenze fra i valori perché utilizzano l’area come segnale visivo. La superficie di un cerchio cresce infatti con il quadrato del raggio, producendo sproporzioni difficili da cogliere a occhio nudo. Un esempio emblematico è il grafico mostrato durante il Discorso sullo Stato dell’Unione del 2011, in cui il PIL degli Stati Uniti appariva molto più grande di quello cinese o francese. In realtà, la distorsione derivava proprio dall’aver reso il raggio proporzionale al valore, trasformando implicitamente la scala in quadratica. La lezione che se ne ricava è semplice: per confronti accurati, meglio affidarsi a posizione e lunghezza, evitando aree o volumi.\n\n::: {.callout-tip title=\"State of the Union\" collapse=\"true\"}\n\n::: {#fig-obama1}\n![](../../figures/state-of-the-union.png){width=\"80%\"}\n\n**Fonte:** @irizarry2024introduction.\n:::\n\n\nIl confronto sottostante illustra l'impatto della scelta tra raggio e area nella rappresentazione grafica:  \n\n::: {#fig-obama2}\n![](../../figures/area-not-radius-1.png){width=\"80%\"}\n\n**Fonte:** @irizarry2024introduction.\n:::\n\n\n::: {#fig-obama3}\n![](../../figures/barplot-better-than-area-1.png){width=\"70%\"}\n\n**Fonte:** @irizarry2024introduction.\n:::\n\nQuesto caso dimostra chiaramente come, per evitare distorsioni percettive, sia una prassi consolidata ottimizzare la visualizzazione dei dati attraverso confronti basati su lunghezze (o posizioni) anziché su aree o volumi, come evidenziato dall'errata rappresentazione del PIL nel grafico originale.\n\n:::\n\n### Ordinamento delle categorie\n\nNei grafici categoriali, disporre le categorie in ordine alfabetico può sembrare neutrale, ma raramente aiuta la comprensione. Ordinare le categorie in base al valore della variabile di interesse, invece, evidenzia immediatamente pattern e relazioni, rendendo la lettura molto più intuitiva.\n\n### Mostrare i dati, non solo le sintesi\n\nI cosiddetti *dynamite plots*, che riportano medie ed errori standard, sono ancora molto diffusi ma comunicano poco e spesso in modo fuorviante. Guardando una semplice barra con un intervallo di errore, non è possibile capire se i dati siano distribuiti in modo simmetrico, se esistano outlier o se i gruppi si sovrappongano. Visualizzazioni che mostrano i singoli dati – ad esempio dot plot arricchiti da tecniche come jitter e trasparenza – permettono invece di cogliere la variabilità interna, facilitano il confronto e raccontano una storia molto più completa.\n\n::: {.callout-tip title=\"Mostrare i dati\" collapse=\"true\"}\n\nConsideriamo il seguente grafico a barre (dynamite plot) che mostra la media (estremità superiore delle barre) e gli errori standard. \n\n::: {#fig-dynamiteplot1}  \n![](../../figures/show-data-1-1.png){width=\"60%\"}  \n\n**Fonte:** @irizarry2024introduction.  \n:::  \n\nQuesta visualizzazione offre informazioni limitate:  \n\n- Le barre partono da 0, suggerendo erroneamente l'esistenza di esseri umani alti pochi centimetri.  \n- Non chiarisce se tutti i maschi siano più alti delle femmine o come siano distribuite le altezze.  \n\n**Un approccio migliore** è quello di **mostrare i dati**:\n\n::: {#fig-dynamiteplot2}  \n![](../../figures/show-data-2-1.png){width=\"70%\"}  \n\n**Fonte:** @irizarry2024introduction.  \n:::  \n\nLa visualizzazione di tutti i punti (238 femmine e 812 maschi) rivela l'intervallo dei dati, ma persiste un problema: i punti sovrapposti ostacolano l'interpretazione.  \n\n**Ottimizzazioni: jitter e trasparenza**  \n\n::: {#fig-dynamiteplot3}  \n![](../../figures/show-points-with-jitter-1.png){width=\"70%\"}  \n\n**Fonte:** @irizarry2024introduction.  \n:::  \n\nDue miglioramenti chiave:  \n\n1. **Jitter orizzontale:** spostamento casuale dei punti per ridurre la sovrapposizione.  \n2. **Alpha blending:** trasparenza graduale: le aree con più dati appaiono più scure.  \n\n**Risultati:**  \n\n- si osserva che i maschi sono **in media** più alti;\n- è chiaro che vi è una grande variabilità e una notevole sovrapposizione tra le due distribuzioni.  \n\nIn sintesi, strumenti semplici, come jitter e trasparenza, migliorano drasticamente l'interpretazione della distribuzione dei dati.\n:::\n\n\n### Confronti coerenti\n\nQuando si confrontano distribuzioni diverse, ad esempio con istogrammi affiancati, è indispensabile utilizzare la stessa scala sugli assi. Differenze apparenti potrebbero dipendere soltanto da un’incoerenza di rappresentazione. Anche l’allineamento dei grafici gioca un ruolo importante: disporli in verticale o in orizzontale con assi coerenti rende il confronto immediato e riduce il rischio di fraintendimenti.\n\n::: {.callout-tip title=\"Facilitare i confronti\" collapse=\"true\"}\n\nPoiché ci sono molti punti, è più efficace mostrare la distribuzione dei dati anziché i singoli valori. Per questo motivo, utilizziamo istogrammi separati per ciascun gruppo:\n\n::: {#fig-histograms-wrong-1}  \n![](../../figures/common-axes-histograms-wrong-1.png){width=\"70%\"}  \n\n**Fonte:** @irizarry2024introduction.  \n:::  \n\nTuttavia, in questo grafico non è immediatamente evidente che, in media, gli uomini siano più alti delle donne. Per accorgersene, bisogna osservare con attenzione e notare che l’asse x del grafico maschile copre un intervallo di valori più ampio. Un principio fondamentale nella comparazione di dati tra due grafici è mantenere **le stesse scale sugli assi**.\n\nNegli istogrammi, l’altezza media si riflette in spostamenti orizzontali: valori più bassi a sinistra, valori più alti a destra. Allineare i grafici in verticale aiuta a visualizzare meglio questa differenza quando gli assi sono coerenti:\n\n::: {#fig-histograms-right-2}  \n![](../../figures/common-axes-histograms-right-2-1.png){width=\"70%\"}  \n\n**Fonte:** @irizarry2024introduction.  \n:::  \n\nQuesto secondo grafico rende molto più evidente che, in media, gli uomini sono più alti delle donne.\n:::\n\n\n### Trasformazioni logaritmiche\n\nMolti dati reali coprono ordini di grandezza molto ampi. In questi casi, una scala lineare comprime la maggior parte delle osservazioni e rende invisibili le differenze più sottili. Le trasformazioni logaritmiche sono uno strumento efficace per restituire leggibilità a distribuzioni fortemente asimmetriche. Altre trasformazioni, come la logistica o la radice quadrata, sono utili rispettivamente per rappresentare rapporti di probabilità o stabilizzare la varianza in dati di conteggio. La scelta della trasformazione non è mai neutrale, ma può illuminare pattern altrimenti nascosti.\n\n::: {.callout-tip title=\"Trasformazioni logaritmiche\" collapse=\"true\"}\nConsideriamo questo **grafico a barre**, che mostra la popolazione media dei paesi di ciascun continente nel 2015:  \n\n::: {#fig-no-transformations-wrong}  \n![](../../figures/no-transformations-wrong-use-of-barplot-1.png){width=\"70%\"}  \n\n**Fonte:** @irizarry2024introduction.  \n:::  \n\nA prima vista, sembrerebbe che i paesi dell’**Asia** siano molto più popolosi rispetto a quelli degli altri continenti. Tuttavia, applicando il principio che ci chiede di *mostrare i dati*, notiamo rapidamente che questa differenza è dovuta alla presenza di due paesi con una popolazione estremamente elevata, presumibilmente **India e Cina**:  \n\n::: {#fig-no-transformations-1}  \n![](../../figures/no-transformation-1.png){width=\"70%\"}  \n\n**Fonte:** @irizarry2024introduction.  \n:::  \n\nConsideriamo ora come la **trasformazione logaritmica** possa migliorare la visualizzazione di dati distribuiti in modo asimmetrico (*right-skewed*). Esistono anche altre trasformazioni utili, come la **logistica (logit)**, impiegata per interpretare variazioni nei rapporti di probabilità (*odds*), e la **radice quadrata (sqrt)**, spesso usata per stabilizzare la varianza nei dati basati su conteggi.  \n\nNel caso della popolazione dei paesi, la distribuzione è fortemente asimmetrica: la maggior parte delle nazioni ha una popolazione relativamente piccola, mentre poche hanno numeri estremamente elevati. Come mostrato nel **boxplot** precedente, questa disparità comprime la maggior parte dei dati in una piccola area del grafico, lasciando molto spazio inutilizzato. Questo rende difficile cogliere le differenze tra la maggior parte dei paesi.  \n\nUna trasformazione logaritmica migliora la leggibilità di uno **scatter plot** quando i dati mostrano una forte asimmetria. Qui, applicando questa tecnica alle popolazioni nazionali, otteniamo una rappresentazione molto più chiara e informativa. Di seguito, confrontiamo il **barplot originale** con un **boxplot** in cui l’asse *y* è stato trasformato con il logaritmo:  \n\n::: {#fig-correct-transformation-1.png}  \n![](../../figures/correct-transformation-1.png){width=\"90%\"}  \n\n**Fonte:** @irizarry2024introduction.  \n:::  \n\nGrazie a questa trasformazione, scopriamo che la mediana della popolazione nei **paesi africani** è in realtà più alta rispetto a quella dei paesi asiatici, un'informazione che il grafico iniziale non rendeva evidente.\n:::\n\n\n### Codifica di variabili aggiuntive\n\nQuando si vogliono rappresentare più di due variabili nello stesso grafico, si possono sfruttare ulteriori canali visivi come colore, forma o dimensione dei punti. È però necessario bilanciare informazione e leggibilità: troppe codifiche simultanee generano confusione. Inoltre, la scelta delle palette cromatiche deve garantire accessibilità, ad esempio evitando combinazioni problematiche per persone con daltonismo.\n\n::: {.callout-tip title=\"Codificare una terza variabile\" collapse=\"true\"}\n\nEsaminiamo la relazione tra **sopravvivenza infantile** e **reddito medio**. Il grafico seguente rappresenta questa relazione includendo tre variabili aggiuntive: **appartenenza all’OPEC**, **regione geografica** e **popolazione**.  \n\n::: {#fig-encoding-third-variable-1.png}  \n![](../../figures/encoding-third-variable-1.png){width=\"60%\"}  \n\n**Fonte:** @irizarry2024introduction.  \n:::  \n\nLe **variabili categoriali** sono rappresentate attraverso il **colore** e la **forma** dei punti. La forma può essere modificata utilizzando l'argomento **shape**.\n:::\n\n### Evitare il 3D superfluo\n\nGrafici tridimensionali, come pie chart o barre in prospettiva, attirano l’occhio ma raramente aggiungono informazione. Anzi, introducono distorsioni che complicano la lettura. Nella maggior parte dei casi, una rappresentazione bidimensionale è più chiara, più fedele e più efficace.\n\n\n### Cifre significative\n\nMostrare un numero eccessivo di decimali non aumenta la precisione, ma rischia di appesantire la lettura. Una o due cifre significative sono quasi sempre sufficienti per trasmettere il messaggio in modo accurato e comprensibile.\n\n### Conoscere il pubblico\n\nInfine, una regola trasversale: ogni visualizzazione deve tenere conto del pubblico di riferimento. Un grafico pensato per un’analisi interna può includere dettagli tecnici e livelli di complessità elevati; al contrario, quando il pubblico non è specializzato, è preferibile semplificare, ridurre il rumore visivo e accompagnare la rappresentazione con spiegazioni chiare.\n\n\n## Introduzione a `ggplot2`\n\nIn R esistono diversi strumenti per creare grafici, ma il pacchetto `ggplot2` si distingue per flessibilità e chiarezza. È diventato lo standard per la visualizzazione dei dati in molti ambiti scientifici, inclusa la psicologia, perché consente di tradurre un dataset complesso in rappresentazioni immediate e leggibili.\n\n\n### Perché usare `ggplot2`?\n\nImmaginiamo di voler analizzare i livelli di ansia di un gruppo di studenti prima di un esame. I dati raccolti in una tabella ci danno informazioni preziose, ma difficili da cogliere a colpo d’occhio. Con un grafico, invece, possiamo visualizzare subito quali studenti mostrano livelli di ansia particolarmente elevati e se l’ansia tende a variare in funzione di caratteristiche come l’*intolleranza all’incertezza* (IU).\n\nPer illustrare le potenzialità di ggplot2, costruiamo un piccolo dataset simulato:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(123)\n\nn <- 200\ngender <- sample(c(0, 1), n, replace = TRUE)\nanxiety <- rnorm(n, mean = 50 + 10 * gender, sd = 10)\nstudy_hours <- rnorm(n, mean = 30 - 0.3 * anxiety, sd = 5)\nIU <- rnorm(n, mean = 50 + 0.5 * anxiety, sd = 10)\n\ndf <- data.frame(\n  id = 1:n,\n  gender = factor(gender, levels = c(0, 1), labels = c(\"Male\", \"Female\")),\n  anxiety = round(anxiety, 1),\n  study_hours = round(study_hours, 1),\n  IU = round(IU, 1)\n)\n\nhead(df)\n#>   id gender anxiety study_hours   IU\n#> 1  1   Male    42.9        13.6 65.4\n#> 2  2   Male    52.6        10.5 66.3\n#> 3  3   Male    47.5        11.0 84.0\n#> 4  4 Female    56.5         7.8 85.8\n#> 5  5   Male    40.5        15.7 55.2\n#> 6  6 Female    59.5        13.8 78.8\n```\n:::\n\n\n\n### La logica di `ggplot2`\n\nAlla base di ogni grafico con ggplot2 ci sono tre elementi fondamentali:\n\n* *i dati*, cioè il dataset da rappresentare;\n* *le geometrie*, ossia il tipo di grafico scelto (punti, barre, linee, boxplot);\n* *la mappatura estetica*, che stabilisce come i dati vengono tradotti in segnali visivi (posizione sugli assi, colore, forma, dimensione).\n\nQuesta struttura rende il pacchetto molto intuitivo: basta dire a ggplot2 quali dati usare, come rappresentarli e con quali convenzioni grafiche.\n\n\n### Un primo esempio\n\nSupponiamo di voler capire se esiste una relazione tra ore di studio e livelli di ansia. Possiamo costruire un semplice *grafico a dispersione*:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\ndf |>\n  ggplot(aes(x = study_hours, y = anxiety)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](05_data_visualization_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nIn questo codice stiamo dicendo a ggplot2 di prendere come riferimento il dataset `df`, di mettere le *ore di studio* sull’asse X, i *livelli di ansia* sull’asse Y e di rappresentare ogni osservazione con un punto.\n\n\n### Personalizzare il grafico\n\nUn aspetto importante di ggplot2 è la possibilità di arricchire facilmente la rappresentazione. Aggiungiamo, per esempio, un colore che distingua maschi e femmine, rendiamo i punti più visibili e inseriamo un titolo e delle etichette agli assi:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf |>\n  ggplot(aes(x = study_hours, y = anxiety, color = gender)) +\n  geom_point(size = 3) +\n  labs(\n    x = \"Ore di studio\",\n    y = \"Livello di ansia\",\n    color = \"Genere\"\n  )\n```\n\n::: {.cell-output-display}\n![](05_data_visualization_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nIl risultato è un grafico più leggibile, in cui la distinzione per genere appare immediatamente chiara.\n\n\n### Altri esempi\n\nCon gli stessi dati possiamo costruire grafici diversi, ciascuno utile a rispondere a domande specifiche. Per esplorare la distribuzione dell’ansia, ad esempio, un *istogramma* è la scelta naturale:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf |>\n  ggplot(aes(x = anxiety)) +\n  geom_histogram(binwidth = 5) +\n  labs(x = \"Livello di ansia\", y = \"Frequenza\")\n```\n\n::: {.cell-output-display}\n![](05_data_visualization_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nSe invece vogliamo confrontare i livelli di ansia tra maschi e femmine, un *boxplot* mette in evidenza la mediana, la variabilità e la presenza di eventuali valori estremi:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf |>\n  ggplot(aes(x = gender, y = anxiety, fill = gender)) +\n  geom_boxplot(alpha = 0.7) +\n  labs(x = \"Genere\", y = \"Livello di ansia\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](05_data_visualization_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nIn sintesi, con pochi comandi, `ggplot2` consente di costruire grafici chiari e informativi. In psicologia, dove spesso si lavora con dataset complessi, è uno strumento prezioso per *trasformare numeri in intuizioni*: una buona visualizzazione permette non solo di comunicare risultati, ma anche di stimolare nuove domande di ricerca.\n\n\n## Riflessioni conclusive {.unnumbered .unlisted}\n\nUna visualizzazione ben progettata ha il potere di trasformare dati complessi in messaggi immediati, riducendo il carico cognitivo e facilitando decisioni più consapevoli. Disegnare un grafico non significa solo scegliere un formato piacevole: implica assumersi la responsabilità di comunicare i risultati in modo corretto, evitando di indurre interpretazioni fuorvianti.\n\nPer raggiungere questo obiettivo, occorre innanzitutto essere chiari sul messaggio che si vuole trasmettere. Un buon grafico è costruito intorno a una domanda precisa e guida lo sguardo del lettore verso gli elementi più rilevanti. Colori, forme e dimensioni non vanno scelti per decorare, ma per orientare l’attenzione: una palette limitata, ben calibrata e accessibile è spesso più efficace di combinazioni cromatiche elaborate. Allo stesso modo, titoli ed etichette devono essere semplici e intuitivi, evitando abbreviazioni o tecnicismi che potrebbero confondere.\n\nÈ importante anche saper gestire la densità dell’informazione. Quando i dati sono numerosi, tecniche come la trasparenza, il jitter o un eventuale sottocampionamento aiutano a prevenire il sovraccarico visivo e rendono le distribuzioni leggibili. Mostrare i dati grezzi, quando possibile, arricchisce l’interpretazione e riduce il rischio che le sintesi statistiche nascondano pattern interessanti.\n\nAlcune buone pratiche ricorrono in quasi tutte le situazioni: ordinare le categorie in base ai valori, e non alfabeticamente, facilita i confronti; mantenere assi coerenti rende più immediata la comparazione tra grafici; partire da zero negli assi dei barplot evita distorsioni nelle proporzioni; usare trasformazioni logaritmiche quando i valori coprono ordini di grandezza molto diversi permette di restituire visibilità anche ai dati più piccoli.\n\nAltre accortezze riguardano la scelta delle codifiche visive. L’aggiunta di variabili tramite colore, forma o dimensione può arricchire un grafico, ma solo se mantiene un equilibrio tra informazione e leggibilità. Le rappresentazioni tridimensionali, al contrario, raramente offrono un reale vantaggio: sono spesso più fuorvianti che utili. Infine, i numeri stessi vanno comunicati con sobrietà: un eccesso di decimali non rende il dato più preciso, ma soltanto più difficile da leggere.\n\nTutte queste regole devono sempre essere rapportate al pubblico a cui ci si rivolge. In un’analisi tecnica interna è possibile includere dettagli complessi, mentre per un pubblico non specializzato occorre semplificare, spiegare e accompagnare la visualizzazione con un linguaggio accessibile. In definitiva, progettare una buona visualizzazione non significa soltanto “disegnare un grafico”, ma costruire un ponte tra i dati e chi li interpreta, con l’obiettivo di rendere la conoscenza condivisibile e utile.\n\n\n::: {.callout-tip title=\"Esercizi\" collapse=\"true\"}\nIn questo esercizio analizzerai i dati raccolti dagli studenti sulla **Satisfaction With Life Scale (SWLS)** e sulla **Lubben Social Network Scale (LSNS-6)**. Le variabili incluse sono:\n\n- **SWLS**: Punteggio totale della Scala di Soddisfazione per la Vita.\n- **LSNS-6**: Punteggio totale sulla scala della rete sociale.\n- **Genere**: Maschio/Femmina.\n- **Tipo di scuola superiore**: Liceo classico o scientifico vs. altro.\n- **Numero di amici**: Auto-riferito.\n- **Numero di uscite settimanali con gli amici**.\n\nUtilizzerai questi dati per esplorare le distribuzioni, creare visualizzazioni efficaci e interpretare i risultati.\n\n**Esercizi Teorici**\n\n1. **Principi della visualizzazione**\n   - Quali sono i principali segnali visivi utilizzati nella visualizzazione dei dati? Fornisci un esempio pratico per ognuno.\n   - Perché la posizione e la lunghezza sono considerati segnali visivi più efficaci rispetto all’area e agli angoli?\n   - Spiega perché i **grafici tridimensionali** (3D) sono spesso inutili o fuorvianti.\n\n2. **Scelta della visualizzazione**\n   - Quale tipo di grafico useresti per mostrare la distribuzione della variabile SWLS? Giustifica la tua risposta.\n   - Se volessi confrontare la distribuzione della SWLS tra due gruppi (ad esempio, in base al **genere**), quale grafico useresti? Perché?\n\n3. **Errori comuni nella visualizzazione**\n   - Perché i **dynamite plots** (grafici a barre con errore standard) sono considerati una cattiva pratica?\n   - Spiega perché è importante iniziare l’asse Y da **zero** in un barplot.\n   - Perché è preferibile ordinare le categorie in base ai valori invece che alfabeticamente?\n\n**Esercizi Pratici in R**\n\n**1. Caricamento e ispezione dei dati**\n\nCarica il dataset raccolto dagli studenti (`dati_SWLS_LSNS.csv`) e stampa un'anteprima dei dati.\n\n```r\n# Caricamento dei dati\ndf <- read.csv(\"dati_SWLS_LSNS.csv\")\n\n# Esamina le prime righe\nhead(df)\n```\n\nRispondi alle seguenti domande:\n\n- Quante osservazioni ci sono nel dataset?\n- Ci sono valori mancanti? Se sì, quanti?\n\n\n**2. Distribuzione delle variabili**\n\nCrea le seguenti visualizzazioni per analizzare la distribuzione di **SWLS** e **LSNS-6**:\n\n- **Istogramma** con sovrapposta la curva di densità.\n- **Funzione di distribuzione cumulativa empirica (eCDF)**.\n- **Box plot** per la variabile SWLS.\n\n\n**3. Confronto tra gruppi**\n\n- Crea un **box plot** della SWLS per **genere**.\n- Crea un **violin plot** della LSNS-6 in base al **tipo di scuola superiore**.\n\n**4. Relazioni tra variabili**\n\n- Crea un **grafico di dispersione (scatter plot)** per verificare se c’è una relazione tra il punteggio **SWLS** e il numero di amici.\n- Aggiungi una linea di regressione al grafico per facilitare l’interpretazione.\n\n```r\nggplot(df, aes(x = numero_amici, y = SWLS)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(\n       x = \"Numero di amici\",\n       y = \"Satisfaction With Life Scale (SWLS)\")\n```\n\nDomande:\n\n- Quale relazione osservi tra il numero di amici e la SWLS?\n- Il numero di amici è un buon predittore della soddisfazione per la vita?\n\n**5. Esplorazione della rete sociale**\n\n- Crea un **barplot** per mostrare la distribuzione delle risposte medie ai sei item della **LSNS-6**.\n- Esplora la relazione tra la **frequenza delle uscite settimanali** e il punteggio totale **LSNS-6** utilizzando un **box plot**.\n\n**Consegna**  \n\nSalva i grafici creati e rispondi alle domande in forma scritta. Carica il file su Moodle.\n:::\n\n::: {.callout-tip title=\"Soluzioni\" collapse=\"true\"}\n\n**1. Risposte alle domande teoriche**\n\nPrincipi della visualizzazione\n\n- I segnali visivi principali sono **posizione, lunghezza, angoli, area, luminosità e colore**.\n- La **posizione e lunghezza** sono i segnali più efficaci perché l’occhio umano è molto preciso nel confrontare distanze e altezze, mentre è meno efficace nel confrontare angoli e aree.\n- I **grafici tridimensionali (3D)** spesso aggiungono confusione senza migliorare la leggibilità.\n\nScelta della visualizzazione\n\n- Per mostrare la distribuzione della SWLS, è preferibile usare **istogrammi e box plot** perché evidenziano la forma della distribuzione e la presenza di outlier.\n- Per confrontare la SWLS tra generi, un **box plot o violin plot** è l’opzione migliore, perché mostra la distribuzione completa.\n\nErrori comuni\n\n- I **dynamite plots** nascondono la distribuzione dei dati e non mostrano la variabilità interna ai gruppi.\n- In un **barplot**, l’asse Y deve iniziare da **zero** per evitare distorsioni visive.\n- Le categorie nei barplot devono essere ordinate per valore per facilitare il confronto.\n\n**2. Soluzioni pratiche in R**\n\n**Caricamento dei dati**\n\n```r\ndf <- read.csv(\"dati_SWLS_LSNS.csv\")\n\n# Esamina il dataset\ndim(df)  # Numero di righe e colonne\nsum(is.na(df))  # Conteggio valori mancanti\n```\n\n**Distribuzione delle variabili**\n\n```r\nggplot(df, aes(x = SWLS)) +\n  geom_histogram(\n  aes(y = after_stat(density)), bins = 10, fill = \"blue\", alpha = 0.5\n  ) +\n  geom_density(color = \"red\", size = 1.2)\n```\n\n```r\nggplot(df, aes(SWLS)) +\n  stat_ecdf(geom = \"step\")\n```\n\n```r\nggplot(df, aes(x = \"\", y = SWLS)) +\n  geom_boxplot() +\n  coord_flip()\n```\n\n**Confronto tra gruppi**\n\n```r\nggplot(df, aes(x = genere, y = SWLS, fill = genere)) +\n  geom_boxplot()\n```\n\n```r\nggplot(df, aes(x = scuola, y = LSNS6, fill = scuola)) +\n  geom_violin()\n```\n\n**Relazioni tra variabili**\n\n```r\nggplot(df, aes(x = numero_amici, y = SWLS)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n```r\nggplot(df, aes(x = uscite_settimanali, y = LSNS6)) +\n  geom_boxplot()\n```\n\n**Conclusioni**\n\n(Ad esempio)\nLe visualizzazioni mostrano che:\n\n- SWLS e LSNS-6 variano in base al genere e al tipo di scuola.\n- Il numero di amici ha un impatto positivo sulla SWLS, ma la relazione è moderata.\n- Il numero di uscite settimanali è correlato positivamente con la rete sociale (LSNS-6).\n:::\n\n::: {.callout-note collapse=true title=\"Informazioni sull'ambiente di sviluppo\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsessionInfo()\n#> R version 4.5.1 (2025-06-13)\n#> Platform: aarch64-apple-darwin20\n#> Running under: macOS Sequoia 15.6.1\n#> \n#> Matrix products: default\n#> BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib \n#> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1\n#> \n#> locale:\n#> [1] C/UTF-8/C/C/C/C\n#> \n#> time zone: Europe/Rome\n#> tzcode source: internal\n#> \n#> attached base packages:\n#> [1] stats     graphics  grDevices utils     datasets  methods   base     \n#> \n#> other attached packages:\n#>  [1] stringr_1.5.1         ggrepel_0.9.6         dslabs_0.8.0         \n#>  [4] pillar_1.11.0         tinytable_0.13.0      patchwork_1.3.2      \n#>  [7] ggdist_3.3.3          tidybayes_3.0.7       bayesplot_1.14.0     \n#> [10] ggplot2_3.5.2         reliabilitydiag_0.2.1 priorsense_1.1.1     \n#> [13] posterior_1.6.1       loo_2.8.0             rstan_2.32.7         \n#> [16] StanHeaders_2.32.10   brms_2.22.0           Rcpp_1.1.0           \n#> [19] sessioninfo_1.2.3     conflicted_1.2.0      janitor_2.2.1        \n#> [22] matrixStats_1.5.0     modelr_0.1.11         tibble_3.3.0         \n#> [25] dplyr_1.1.4           tidyr_1.3.1           rio_1.2.3            \n#> [28] here_1.0.1           \n#> \n#> loaded via a namespace (and not attached):\n#>  [1] svUnit_1.0.8          tidyselect_1.2.1      farver_2.1.2         \n#>  [4] fastmap_1.2.0         TH.data_1.1-4         tensorA_0.36.2.1     \n#>  [7] pacman_0.5.1          digest_0.6.37         timechange_0.3.0     \n#> [10] estimability_1.5.1    lifecycle_1.0.4       survival_3.8-3       \n#> [13] magrittr_2.0.3        compiler_4.5.1        rlang_1.1.6          \n#> [16] tools_4.5.1           knitr_1.50            labeling_0.4.3       \n#> [19] bridgesampling_1.1-2  htmlwidgets_1.6.4     curl_7.0.0           \n#> [22] pkgbuild_1.4.8        RColorBrewer_1.1-3    abind_1.4-8          \n#> [25] multcomp_1.4-28       withr_3.0.2           purrr_1.1.0          \n#> [28] grid_4.5.1            stats4_4.5.1          colorspace_2.1-1     \n#> [31] xtable_1.8-4          inline_0.3.21         emmeans_1.11.2-8     \n#> [34] scales_1.4.0          MASS_7.3-65           cli_3.6.5            \n#> [37] mvtnorm_1.3-3         rmarkdown_2.29        ragg_1.5.0           \n#> [40] generics_0.1.4        RcppParallel_5.1.11-1 cachem_1.1.0         \n#> [43] splines_4.5.1         parallel_4.5.1        vctrs_0.6.5          \n#> [46] V8_7.0.0              Matrix_1.7-4          sandwich_3.1-1       \n#> [49] jsonlite_2.0.0        arrayhelpers_1.1-0    systemfonts_1.2.3    \n#> [52] glue_1.8.0            codetools_0.2-20      distributional_0.5.0 \n#> [55] lubridate_1.9.4       stringi_1.8.7         gtable_0.3.6         \n#> [58] QuickJSR_1.8.0        htmltools_0.5.8.1     Brobdingnag_1.2-9    \n#> [61] R6_2.6.1              textshaping_1.0.3     rprojroot_2.1.1      \n#> [64] evaluate_1.0.5        lattice_0.22-7        backports_1.5.0      \n#> [67] memoise_2.0.1         broom_1.0.9           snakecase_0.11.1     \n#> [70] rstantools_2.5.0      coda_0.19-4.1         gridExtra_2.3        \n#> [73] nlme_3.1-168          checkmate_2.3.3       xfun_0.53            \n#> [76] zoo_1.8-14            pkgconfig_2.0.3\n```\n:::\n\n:::\n\n## Bibliografia {.unnumbered .unlisted}\n\n",
    "supporting": [
      "05_data_visualization_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}