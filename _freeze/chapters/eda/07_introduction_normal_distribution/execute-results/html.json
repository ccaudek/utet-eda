{
  "hash": "016a10ebeaa0baff81021711aaeef3b7",
  "result": {
    "engine": "knitr",
    "markdown": "# Introduzione alla distribuzione normale {#sec-eda-intro-gauss}\n\n::: {.epigraph}\n> “L'uomo normale è un'astrazione che non esiste in pratica, una finzione legale, e la curva normale è una cosa altrettanto irreale.”\n>\n> -- **Otto Neurath**, Filosofo ed economista\n:::\n\n\n## Introduzione {.unnumbered .unlisted}\n\nIn questo capitolo forniremo un primo sguardo alla distribuzione normale, che sarà trattata in modo più approfondito nel @sec-prob-cont-prob-distr. Introduciamo la distribuzione normale a questo punto poiché essa spiega in modo chiaro perché, in molte analisi, media e deviazione standard siano impiegate come principali descrittori di una distribuzione.\n\n### Panoramica del capitolo {.unnumbered .unlisted}\n\n- Che cos'è la distribuzione normale?\n- Come si costruisce e come si interpreta la distribuzione normale normalizzata.\n- Cosa sono e come si interpretanto i diagrammi quantile-quantile.\n- Distribuzione normale e statistiche descrittive.\n\n\n::: {.callout-tip collapse=true}\n## Prerequisiti\n\n- Leggere il capitolo [Exploring numerical data](https://openintro-ims.netlify.app/explore-numerical) di [Introduction to Modern Statistics (2e)](https://openintro-ims.netlify.app) di Mine Çetinkaya-Rundel e Johanna Hardin.\n- Leggere il capitolo *Distributions* di *Introduction to Data Science* [@irizarry2024introduction].\n:::\n\n::: {.callout-caution collapse=true =\"Preparazione del Notebook\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhere::here(\"code\", \"_common.R\") |> \n  source()\n\n# Load packages\nif (!requireNamespace(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(ggbeeswarm, dslabs, gridExtra)\n```\n:::\n\n:::\n\n\n## La distribuzione normale {#sec-normal-distribution}\n\nNel @sec-eda-exploring-num-data, abbiamo visto come gli istogrammi e i grafici di densità forniscano utili riassunti visivi di una distribuzione. In questo capitolo, ci chiediamo se sia possibile riassumere una distribuzione in modo ancora più sintetico. Spesso si fa riferimento a media e deviazione standard come statistiche riassuntive fondamentali: in sostanza, un riassunto in due numeri. Per comprendere appieno il ruolo di questi valori, dobbiamo prima capire come è definita la distribuzione normale.\n\nLa distribuzione normale, nota anche come curva a campana o distribuzione gaussiana, è uno dei concetti matematici più conosciuti (si veda il @sec-prob-cont-prob-distr). Uno dei motivi della sua fama è che numerose variabili nella realtà seguono, almeno approssimativamente, una distribuzione normale. Esempi includono le vincite nel gioco d’azzardo, l’altezza e il peso delle persone, la pressione sanguigna, i punteggi di alcuni test standardizzati e gli errori di misura negli esperimenti. I motivi matematici e probabilistici di queste approssimazioni verranno discussi in seguito; qui ci concentreremo sul come la distribuzione normale aiuti a riassumere i dati.\n\nAnziché partire da dati empirici, la distribuzione normale si definisce tramite una formula matematica. Per un intervallo generico $(a,b)$, la proporzione di valori che cade in tale intervallo si ottiene mediante:\n\n$$\n\\text{Pr}(a < x \\leq b) \\;=\\; \\int_a^b \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\, e^{-\\tfrac12\\,\\bigl(\\tfrac{x - \\mu}{\\sigma}\\bigr)^2}\\, dx .\n$$ {#eq-gaussian-density}\n\nNon è necessario memorizzare o padroneggiare i dettagli di questa formula, ma è importante sapere che la distribuzione normale è completamente determinata da due soli parametri: $\\mu$ e $\\sigma$. Gli altri simboli nella formula ($\\pi$, $e$, $a$, $b$) rappresentano costanti matematiche o gli estremi dell’intervallo. In particolare, $\\mu$ è il valore medio (o media) e $\\sigma$ è la deviazione standard.\n\nQuesta distribuzione è simmetrica, centrata sulla media $\\mu$, e la maggior parte dei valori (circa il 95%) si trova entro 2 deviazioni standard dalla media, cioè nell’intervallo $\\mu \\pm 2\\sigma$. Ecco un esempio di come appare la distribuzione normale quando $\\mu = 0$ e $\\sigma = 1$:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm <- 0; s <- 1\nnorm_dist <- tibble(x = seq(-4, 4, length.out = 50)*s + m) |> \n  mutate(density = dnorm(x, m, s))\nnorm_dist |> \n  ggplot(aes(x, density)) + geom_line()\n```\n\n::: {.cell-output-display}\n![](07_introduction_normal_distribution_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nIl fatto che la distribuzione sia descritta da due parametri implica che, se un insieme di dati reali si approssima bene a una distribuzione normale, due soli numeri (media e deviazione standard) possono fornire un riassunto sintetico della distribuzione. Vediamo ora come si calcolano, in pratica, questi due parametri per una lista di valori arbitraria.\n\nSupponiamo di avere un vettore `x` che contiene una serie di valori numerici. Abbiamo visto come, in R, la media si trova come:\n\n```r\nm <- sum(x) / length(x)\n```\n\ne la deviazione standard è:\n\n```r\ns <- sqrt(sum((x - m)^2) / length(x))\n```\n\nLa deviazione standard si può interpretare come la distanza media dei valori dalla loro media.\n\n\n### Un esempio pratico\n\nPer calcolare media e deviazione standard dell’altezza maschile in un dataset, ipotizziamo che il vettore `heights$height` contenga le altezze di alcuni individui, mentre `heights$sex` contenga il genere corrispondente. Se vogliamo estrarre solo i valori relativi ai maschi, possiamo scrivere:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nindex <- heights$sex == \"Male\"\nx <- heights$height[index]\n```\n:::\n\n\nQuindi usiamo le funzioni predefinite di R:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm <- mean(x)\ns <- sd(x)\n```\n:::\n\n\n::: callout-warning\n**Nota**: Per motivi che verranno chiariti in seguito, la funzione `sd(x)` effettua una divisione per $\\text{length}(x) - 1$ invece che per $\\text{length}(x)$. Tuttavia, se il numero di osservazioni è elevato, questa differenza è trascurabile.  \n:::\n\nPossiamo ora mettere a confronto la curva di densità osservata dei dati (in blu) con quella teorica (in nero) della distribuzione normale con media e deviazione standard stimate:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnorm_dist <- tibble(\n  x = seq(-4, 4, length.out = 50)*s + m) |> \n  mutate(density = dnorm(x, m, s))\n\nheights |> \n  dplyr::filter(sex == \"Male\") |> \n  ggplot(aes(height)) +\n  geom_density(fill = \"lightblue\") +\n  geom_line(aes(x, density), linewidth=1.5, data = norm_dist)\n```\n\n::: {.cell-output-display}\n![](07_introduction_normal_distribution_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nCome si vede, la curva normale fornisce una buona approssimazione per i dati sull’altezza maschile. Vedremo ora come verificare l’aderenza di una distribuzione ai dati, osservando le proporzioni di valori entro intervalli specifici.\n\n\n## Unità standard\n\nPer i dati che seguono (o quasi) una distribuzione normale, è molto comodo utilizzare le cosiddette unità standard (*Standard Units*). Un valore $x$ viene convertito in unità standard tramite la formula:\n\n$$\nz = \\frac{x - m}{s} ,\n$$\n\ndove $m$ e $s$ sono la media e la deviazione standard della distribuzione. Questa trasformazione ci dice di quante deviazioni standard un particolare valore si discosta dalla media. Ad esempio, se $z=0$, il valore $x$ corrisponde esattamente alla media; se $z = 2$, il valore $x$ si trova a due deviazioni standard sopra la media; se $z = -2$, a due deviazioni standard sotto la media, e così via.\n\nIn R, possiamo calcolare le unità standard con la funzione:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nz <- scale(x) |> as.numeric()\nhead(z)\n#> [1]  1.574  0.190 -0.364  1.297 -2.303 -0.641\n```\n:::\n\n\nSe vogliamo sapere, ad esempio, quale frazione di individui si trova entro 2 deviazioni standard dalla media (cioè $|z| < 2$), basta scrivere:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmean(abs(z) < 2)\n#> [1] 0.95\n```\n:::\n\n\nVedremo, in molti casi, un valore intorno al 95%, in linea con quanto previsto dalla distribuzione normale. Per confermare la bontà dell’approssimazione, si usano spesso i grafici quantile-quantile, detti anche *qqplot*.\n\n\n## Grafici quantile-quantile \n\nUn modo sistematico per verificare quanto la distribuzione normale descriva bene i dati osservati consiste nel confrontare i quantili empirici con quelli teorici di una normale. Se i due insiemi di quantili sono molto simili, abbiamo un’ulteriore conferma dell’aderenza alla normalità.\n\n- La funzione di ripartizione della distribuzione normale standard si indica spesso con $\\Phi(x)$. Ad esempio, $\\Phi(-1.96) \\approx 0.025$ e $\\Phi(1.96) \\approx 0.975$.  \n- L’inversa di $\\Phi$, indicata come $\\Phi^{-1}(p)$, ci dà il quantile corrispondente a una determinata probabilità $p$. In R, `pnorm` calcola $\\Phi(x)$ e `qnorm` calcola $\\Phi^{-1}(p)$. Di default, `pnorm` e `qnorm` si riferiscono alla normale standard (media 0, deviazione standard 1), ma possiamo specificare valori diversi di media e deviazione standard tramite gli argomenti `mean` e `sd`.\n\nPer ottenere il quantile empirico da un vettore di dati in R, possiamo usare la funzione `quantile`. Ad esempio, se abbiamo un vettore `x`, il quantile associato alla probabilità $p$ è il valore $q$ per il quale `mean(x <= q) = p`.\n\nEcco lo schema logico per costruire un qqplot:\n\n1.  Definiamo un vettore di proporzioni $p_1, p_2, \\dots, p_m$.  \n2.  Calcoliamo i relativi quantili empirici dei nostri dati $\\{q_1, \\dots, q_m\\}$ usando `quantile(x, p_i)`.  \n3.  Calcoliamo i quantili teorici della normale (con la stessa media e la stessa deviazione standard dei dati) usando `qnorm(p_i, mean, sd)`.  \n4.  Rappresentiamo i punti $(\\text{quantile teorico}, \\text{quantile empirico})$. Se i dati sono davvero normali, tali punti si disporranno approssimativamente lungo la retta diagonale `y = x`.\n\nEsempio in R:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- seq(0.05, 0.95, 0.05)\nsample_quantiles <- quantile(x, p)\ntheoretical_quantiles <- qnorm(p, mean = mean(x), sd = sd(x))\n\nqplot(theoretical_quantiles, sample_quantiles) + geom_abline()\n```\n\n::: {.cell-output-display}\n![](07_introduction_normal_distribution_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nSe però abbiamo già convertito in unità standard (quindi $\\mu = 0$ e $\\sigma = 1$), il confronto si semplifica:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsample_quantiles <- quantile(z, p)\ntheoretical_quantiles <- qnorm(p)\nqplot(theoretical_quantiles, sample_quantiles) + geom_abline()\n```\n\n::: {.cell-output-display}\n![](07_introduction_normal_distribution_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nIn pratica, per creare rapidamente un qqplot si usa spesso ggplot2 con la geometria `geom_qq`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nheights |> filter(sex == \"Male\") |>\n  ggplot(aes(sample = scale(height))) + \n  geom_qq() +\n  geom_abline()\n```\n\n::: {.cell-output-display}\n![](07_introduction_normal_distribution_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nCome abbiamo sottolineato, se i punti nel qqplot si dispongono lungo una retta, significa che la distribuzione dei dati è in accordo con la distribuzione teorica considerata (in questo caso, la normale). I qqplot possono essere usati anche per confrontare qualsiasi coppia di distribuzioni, non solo dati e normale teorica.\n\nQuesto indica che l’approssimazione normale è accurata per il gruppo maschile (nel nostro dataset). \n\n## Media e deviazione standard come statistiche descrittive della distribuzione\n\nLa media e la deviazione standard sono due delle statistiche più comunemente utilizzate per descrivere la distribuzione di un insieme di dati. Queste misure sono particolarmente utili quando i dati seguono una distribuzione normale. In questo caso, la media e la deviazione standard contengono tutte le informazioni necessarie per caratterizzare completamente la forma della distribuzione.\n\n### Distribuzione normale e statistiche descrittive\n\nLa distribuzione normale è definita dalla sua media ($\\mu$) e dalla sua deviazione standard ($\\sigma$). La formula della densità di probabilità della distribuzione normale è data dall'@eq-gaussian-density. Questa formula mostra che, conoscendo solo $\\mu$ e $\\sigma$, possiamo ricostruire l'intera curva di densità. Pertanto, se i dati empirici sono ben approssimati da una distribuzione normale, la media e la deviazione standard sono sufficienti per descrivere la distribuzione.\n\nSupponiamo di avere un dataset che segue una distribuzione normale con media 50 e deviazione standard 10. Possiamo generare dati casuali e visualizzare la curva di densità in R:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Generiamo dati da una distribuzione normale\nset.seed(123)\ndati <- rnorm(1000, mean = 50, sd = 10)\n\n# Calcoliamo media e deviazione standard\nmedia <- mean(dati)\ndeviazione_standard <- sd(dati)\n\n# Visualizziamo la curva di densità\nggplot(data.frame(dati), aes(x = dati)) +\n  geom_density(fill = \"lightblue\") +\n  geom_vline(xintercept = media, color = \"red\", linetype = \"dashed\") +\n  labs(\n       x = \"Valori\",\n       y = \"Densità\") +\n  annotate(\"text\", x = media + 5, y = 0.03, label = paste(\"Media =\", round(media, 2)), color = \"red\") +\n  annotate(\"text\", x = media + 5, y = 0.025, label = paste(\"Deviazione Standard =\", round(deviazione_standard, 2)), color = \"blue\")\n```\n\n::: {.cell-output-display}\n![](07_introduction_normal_distribution_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nIn questo esempio:\n\n- La curva di densità è centrata attorno alla media ($\\mu = 50$).\n- La deviazione standard ($\\sigma = 10$) determina la dispersione dei dati attorno alla media.\n\n### Quando media e deviazione standard non sono sufficienti\n\nSebbene media e deviazione standard siano strumenti estremamente utili per descrivere distribuzioni normali, non sempre bastano a cogliere tutte le caratteristiche di un insieme di dati. In particolare, ci sono situazioni in cui la forma della distribuzione rende necessario ricorrere a misure aggiuntive. Di seguito presentiamo alcuni casi tipici.\n\n1. **Distribuzioni Asimmetriche**  \n   Una distribuzione si dice asimmetrica (o *skewed*) quando una coda è più “estesa” dell’altra.  \n   - Se la coda più lunga è a destra, la distribuzione è *asimmetrica positiva* (o a destra).  \n   - Se la coda più lunga è a sinistra, la distribuzione è *asimmetrica negativa* (o a sinistra).  \n   In queste circostanze, la media tende a spostarsi verso la coda più lunga, mentre la mediana rimane più stabile e rappresentativa del valore centrale.  \n\n2. **Distribuzioni Multimodali**  \n   Una distribuzione è multimodale quando presenta più picchi (o “modi”). Ciò significa che i dati si concentrano attorno a più di un valore, formando veri e propri sotto-gruppi. In questi casi, media e deviazione standard possono risultare poco significative, poiché non colgono la presenza di più poli di concentrazione.\n\n3. **Kurtosi**  \n   La **kurtosi** descrive quanto una distribuzione sia “appuntita” o “piatta” rispetto a una normale.  \n   - **Alta kurtosi** indica picchi molto accentuati e code più lunghe, con una maggiore probabilità di valori estremi.  \n   - **Bassa kurtosi** segnala una forma più appiattita, con code ridotte e meno outlier.  \n\nQuando le distribuzioni mostrano una di queste peculiarità, altre statistiche possono rivelarsi più informative:  \n\n- La mediana, insensibile ai valori estremi, fornisce una descrizione più robusta del centro.  \n- I quartili, e in particolare l’intervallo interquartile, danno un’idea della dispersione principale trascurando le code.  \n- L’indice di asimmetria (*skewness*) misura il grado di sbilanciamento della distribuzione.  \n- L’indice di curtosi (*kurtosis*) quantifica la “pesantezza” delle code.\n\nNel seguente esempio, generiamo dati da una distribuzione esponenziale, notoriamente asimmetrica:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Generiamo dati da una distribuzione esponenziale\nset.seed(123)\ndati_esponenziali <- rexp(1000, rate = 0.5)\n\n# Calcoliamo media e deviazione standard\nmedia_esp <- mean(dati_esponenziali)\ndeviazione_standard_esp <- sd(dati_esponenziali)\n\n# Visualizziamo la curva di densità\nggplot(data.frame(dati_esponenziali), aes(x = dati_esponenziali)) +\n  geom_density(fill = \"#F8766D\", alpha = 0.6) +\n  geom_vline(xintercept = media_esp, color = \"red\", linetype = \"dashed\") +\n  labs(\n       x = \"Valori\",\n       y = \"Densità\") +\n  annotate(\"text\", x = media_esp + 1, y = 0.2, \n           label = paste(\"Media =\", round(media_esp, 2)), \n           color = \"red\") +\n  annotate(\"text\", x = media_esp + 1, y = 0.18, \n           label = paste(\"Deviazione Standard =\", round(deviazione_standard_esp, 2)), \n           color = \"blue\")\n```\n\n::: {.cell-output-display}\n![](07_introduction_normal_distribution_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nL’istogramma (o la densità) mostra chiaramente una coda lunga a destra, con molti valori piccoli e pochi valori grandi. In questo contesto:  \n\n- La media tende a seguire la coda, diventando meno rappresentativa del “centro”.  \n- La deviazione standard non descrive in modo efficace la variabilità, perché non considera adeguatamente la forte asimmetria.\n\nMisure alternative, come la mediana e i quartili, forniscono informazioni più affidabili:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Calcoliamo mediana e quartili\nmediana <- median(dati_esponenziali)\nquartili <- quantile(dati_esponenziali, probs = c(0.25, 0.75))\n\ncat(\"Mediana:\", mediana, \"\\n\")\n#> Mediana: 1.46\ncat(\"Primo Quartile (Q1):\", quartili[1], \"\\n\")\n#> Primo Quartile (Q1): 0.613\ncat(\"Terzo Quartile (Q3):\", quartili[2], \"\\n\")\n#> Terzo Quartile (Q3): 2.85\n```\n:::\n\n\nIn conclusione, quando i dati non presentano una forma vicina alla normalità (ad esempio perché asimmetrici, multimodali o con kurtosi anomala), media e deviazione standard possono risultare fuorvianti o poco utili. In questi casi, è fondamentale adottare misure alternative o complementari (mediana, quartili, skewness, kurtosis) per ottenere una descrizione più accurata della distribuzione. \n\n\n## Riflessioni conclusive {.unnumbered .unlisted}\n\nIn questo capitolo, abbiamo esplorato alcuni concetti fondamentali per l'analisi dei dati e consolidato le basi per un'interpretazione più approfondita delle distribuzioni. In particolare, abbiamo:\n\n- **Studiato la distribuzione normale**, una delle distribuzioni più importanti in statistica, e compreso perché la media e la deviazione standard siano parametri cruciali per descriverla. Questi indicatori ci permettono di riassumere in modo efficace le caratteristiche centrali e la variabilità dei dati.\n- **Imparato a standardizzare i dati** convertendoli in unità standard (z-score), il che ci consente di confrontare variabili con scale diverse o di valutare quanto un dato specifico si discosti dalla media in termini di deviazioni standard.\n- **Introdotto il grafico quantile-quantile (QQ-plot)**, uno strumento visivo prezioso per verificare se i nostri dati seguono una distribuzione normale. Attraverso il QQ-plot, possiamo confrontare i quantili empirici dei nostri dati con quelli teorici della distribuzione normale, identificando eventuali deviazioni.\n\nGli strumenti descritti in questo capitolo rappresentano il primo passo essenziale nell'analisi esplorativa dei dati. Essi ci aiutano a formulare ipotesi solide e a riconoscere potenziali problemi o caratteristiche peculiari dei dati prima di applicare metodi statistici più avanzati, che approfondiremo nei prossimi capitoli.  \n\nL'analisi esplorativa, combinando grafici intuitivi e statistiche descrittive appropriate, riveste quindi un ruolo fondamentale nel processo analitico. Essa non solo ci aiuta a comprendere meglio la natura dei dati, ma ci fornisce anche una base solida su cui costruire conclusioni statistiche attendibili e informate.\n\n\n## Esercizi {.unnumbered .unlisted}\n\n::: {.callout-tip =\"Esercizi\" collapse=\"true\"}\n**Esercizi Teorici**  \n\n**Rispondi alle seguenti domande** per consolidare la comprensione teorica della distribuzione normale e dei suoi concetti chiave.\n\n1. **Caratteristiche della distribuzione normale**  \n   - Quali sono i due parametri principali della distribuzione normale?  \n   - Perché la distribuzione normale è utilizzata così frequentemente in statistica?  \n   - In quali situazioni reali possiamo aspettarci che una variabile segua una distribuzione normale?  \n\n2. **Media e deviazione standard**  \n   - Qual è il significato della media in una distribuzione normale?  \n   - Cosa rappresenta la deviazione standard?  \n   - In che modo la deviazione standard influenza la forma della curva normale?  \n\n3. **Z-score e standardizzazione**  \n   - Cos'è uno z-score e come si calcola?  \n   - Qual è il significato di un valore z=2? E di un valore z=-1.5?  \n   - Dopo la standardizzazione, quali saranno la media e la deviazione standard della variabile?  \n\n4. **Verifica della normalità**  \n   - Se hai un piccolo campione di dati (circa 15 osservazioni), quali metodi grafici puoi utilizzare per valutare se segue una distribuzione normale?  \n   - Quali strumenti statistici puoi impiegare per testare la normalità?  \n   - In un QQ-plot, come puoi riconoscere se i dati seguono una distribuzione normale?  \n\n**Esercizi Pratici in R**  \n\n**Obiettivo**: Analizzare i dati raccolti dagli studenti sulla **Satisfaction With Life Scale (SWLS)**, comprendere la loro distribuzione e confrontarli con una distribuzione normale teorica.  \n\n**Dati disponibili**:  \nUsa i dati della SWLS. I dati contengono anche informazioni sul genere e su un indice di rete sociale (LSNS).  \n\n**1. Esplorazione e Visualizzazione dei Dati SWLS**\n\n1. **Carica i dati raccolti dagli studenti** e verifica la struttura del dataset.  \n2. **Calcola i valori di base**: media, deviazione standard, minimo, massimo, e quantili della SWLS.  \n3. **Crea una rappresentazione visiva dei dati**:  \n   - Istogramma con sovrapposta una curva di densità.  \n   - Boxplot per identificare eventuali outlier.  \n   - Violin plot per osservare la distribuzione.  \n\n**2. Confronto con la Distribuzione Normale**\n\n1. **Sovrapponi ai dati osservati una curva normale teorica** basata su media e deviazione standard stimate dal campione.  \n2. **Confronta i quantili empirici con quelli teorici** mediante un **QQ-plot**.  \n3. **Commenta il risultato**: i dati SWLS seguono approssimativamente una normale? Se no, quali differenze noti?  \n\n**3. Standardizzazione dei Punteggi SWLS**\n\n1. **Trasforma i dati della SWLS in z-score** per analizzarli in unità standardizzate.\n2. **Verifica la nuova media e deviazione standard**: dovrebbero essere 0 e 1 rispettivamente.  \n3. **Conta quanti punteggi standardizzati si trovano entro 1, 2 e 3 deviazioni standard dalla media** e confronta i valori attesi di 68%, 95% e 99.7%.  \n\n**4. Relazione tra SWLS e Interazione Sociale (LSNS)**\n\n1. **Esplora la relazione tra SWLS e il punteggio della Scala della Rete Sociale di Lubben (LSNS-6)**.  \n2. **Costruisci un grafico a dispersione** per osservare la correlazione tra le due variabili.  \n3. **Calcola il coefficiente di correlazione di Pearson** e commenta il risultato. Esiste una relazione tra soddisfazione della vita e supporto sociale?  \n:::\n\n::: {.callout-tip =\"Soluzioni\" collapse=\"true\"}\n**1. Caratteristiche della distribuzione normale**\n\n**a. Quali sono i due parametri principali della distribuzione normale?**\n\nI due parametri principali che definiscono una distribuzione normale sono:\n\n- **La media (μ)**: Indica il centro della distribuzione. Tutte le osservazioni si raggruppano attorno a questo valore.\n- **La deviazione standard (σ)**: Descrive la dispersione o la variabilità dei dati attorno alla media.\n\n**b. Perché la distribuzione normale è utilizzata così frequentemente in statistica?**\n\nLa distribuzione normale è ampiamente usata per diversi motivi:\n\n1. **Teorema del limite centrale**: Afferma che, quando si sommano molte variabili casuali indipendenti, la loro distribuzione tende ad avvicinarsi a una normale, indipendentemente dalla forma originale delle singole distribuzioni.\n2. **Semplicità matematica**: La normale ha proprietà matematiche ben definite e permette di calcolare probabilità e intervalli con facilità.\n3. **Modellizzazione naturale**: Molte variabili naturali e sociali (ad esempio, altezze, pesi, punteggi standardizzati) seguono approssimativamente una distribuzione normale.\n\n**c. In quali situazioni reali possiamo aspettarci che una variabile segua una distribuzione normale?**\n\nSi può aspettare una distribuzione normale in situazioni in cui:\n\n- Le osservazioni sono influenzate da molti fattori casuali indipendenti (es. altezza di un individuo, errore di misurazione).\n- I dati derivano da fenomeni naturali o biologici (es. pressione sanguigna, peso corporeo).\n- Si analizzano medie campionarie di grandi dimensioni (grazie al teorema del limite centrale).\n\n**2. Media e deviazione standard**\n\n**a. Qual è il significato della media in una distribuzione normale?**\n\nNella distribuzione normale, la media rappresenta il punto centrale della curva, ovvero il valore più probabile. È anche il punto di simmetria della distribuzione, dove metà delle osservazioni si trova a sinistra e l'altra metà a destra.\n\n**b. Cosa rappresenta la deviazione standard?**\n\nLa deviazione standard misura quanto i dati si discostano in media dalla media. Una deviazione standard bassa indica che i dati sono raggruppati strettamente attorno alla media, mentre una deviazione standard alta indica una maggiore dispersione.\n\n**c. In che modo la deviazione standard influenza la forma della curva normale?**\n\n- Una deviazione standard piccola produce una curva alta e stretta, indicando una bassa variabilità.\n- Una deviazione standard grande produce una curva bassa e larga, indicando una maggiore variabilità.\n\n**3. Z-score e standardizzazione**\n\n**a. Cos'è uno z-score e come si calcola?**\n\nUno z-score misura quante deviazioni standard un dato si discosta dalla media. Viene calcolato come:\n\n$$\nz = \\frac{x - \\mu}{\\sigma}\n$$\n\ndove $x$ è il valore osservato, $\\mu$ è la media e $\\sigma$ è la deviazione standard.\n\n**b. Qual è il significato di un valore z=2? E di un valore z=-1.5?**\n\n- Un $z = 2$ significa che il dato è posizionato a 2 deviazioni standard sopra la media.\n- Un $z = -1.5$ significa che il dato è posizionato a 1.5 deviazioni standard sotto la media.\n\n**c. Dopo la standardizzazione, quali saranno la media e la deviazione standard della variabile?**\n\nDopo la standardizzazione:\n\n- La media diventa $0$.\n- La deviazione standard diventa $1$.\n\n**4. Verifica della normalità**\n\n**a. Se hai un piccolo campione di dati (circa 15 osservazioni), quali metodi grafici puoi utilizzare per valutare se segue una distribuzione normale?**\n\nPer piccoli campioni, i metodi grafici più utili sono:\n\n1. **QQ-plot (Quantile-Quantile plot)**: Confronta i quantili dei dati con quelli di una distribuzione normale. Se i punti seguono una retta diagonale, i dati sono normali.\n2. **Istogramma**: Mostra la distribuzione dei dati, ma con campioni piccoli può essere meno preciso.\n\n**b. Quali strumenti statistici puoi impiegare per testare la normalità?**\n\nGli strumenti statistici più comuni per verificare la normalità sono:\n\n- **Test di Shapiro-Wilk**: Ideale per piccoli campioni.\n- **Test di Kolmogorov-Smirnov**: Usato per confrontare la distribuzione empirica con una normale.\n- **Test di Anderson-Darling**: Sensibile alle code della distribuzione.\n\n**c. In un QQ-plot, come puoi riconoscere se i dati seguono una distribuzione normale?**\n\nIn un QQ-plot:\n\n- Se i dati seguono una distribuzione normale, i punti si allineeranno lungo una retta diagonale.\n- Deviazioni dalla retta indicano departi dalla normalità:\n  - Code pesanti: Punti esterni alla retta suggeriscono outlier.\n  - Asimmetria: Punti curvati suggeriscono skewness (asimmetria).\n\n**Esplorazione e Visualizzazione dei Dati SWLS**\n\n**Caricamento e struttura dei dati**\n```r\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Supponiamo che i dati siano i seguenti\nset.seed(42)\nswls <- data.frame(\n  ID = 1:15,\n  SWLS = c(18, 22, 25, 21, 26, 19, 20, 23, 24, 17, 22, 27, 28, 21, 19),\n  Genere = c(\"M\", \"F\", \"F\", \"M\", \"F\", \"M\", \"M\", \"F\", \"M\", \"F\", \"M\", \"F\", \"F\", \"M\", \"M\"),\n  LSNS = c(16, 20, 22, 14, 19, 18, 17, 25, 23, 12, 21, 28, 26, 19, 15)\n)\n\nstr(swls)\nsummary(swls$SWLS)\n```\n\n**Visualizzazioni**\n\n```r\n# Istogramma con curva di densità\nggplot(swls, aes(x = SWLS)) +\n  geom_histogram(aes(y = after_stat(density)), bins = 6, fill = \"blue\", alpha = 0.5) +\n  geom_density(color = \"red\", size = 1) +\n  gg(\"Distribuzione dei punteggi SWLS\")\n\n# Boxplot\nggplot(swls, aes(y = SWLS)) +\n  geom_boxplot(fill = \"cyan\") +\n  gg(\"Boxplot dei punteggi SWLS\")\n```\n\n**2. Confronto con la Distribuzione Normale**\n\n```r\n# QQ-plot per valutare la normalità\nggplot(swls, aes(sample = SWLS)) +\n  geom_qq() +\n  geom_abline() +\n  gg(\"QQ-plot dei punteggi SWLS\") +\n  theme_minimal()\n```\n\n**Osservazione**:  \n\n- Se i punti si allineano lungo la diagonale, i dati sono approssimativamente normali.\n- Se ci sono deviazioni marcate, la distribuzione potrebbe essere asimmetrica o presentare code pesanti.  \n\n**3. Standardizzazione dei punteggi SWLS**\n\n```r\nswls$Z_SWLS <- scale(swls$SWLS)\n\nmean(swls$Z_SWLS)  # Dovrebbe essere circa 0\nsd(swls$Z_SWLS)    # Dovrebbe essere circa 1\n\n# Proporzione entro 1, 2, 3 deviazioni standard\nmean(abs(swls$Z_SWLS) < 1)  # Atteso ~68%\nmean(abs(swls$Z_SWLS) < 2)  # Atteso ~95%\nmean(abs(swls$Z_SWLS) < 3)  # Atteso ~99.7%\n```\n\n**4. Relazione tra SWLS e LSNS**\n\n```r\n# Grafico di dispersione\nggplot(swls, aes(x = LSNS, y = SWLS)) +\n  geom_point(color = \"blue\", size = 3) +\n  geom_smooth(method = \"lm\", color = \"red\", se = FALSE) +\n  gg(\"Relazione tra SWLS e LSNS\") \n\n# Calcolo della correlazione\ncor(swls$SWLS, swls$LSNS)\n```\n\n**Interpretazione**:  \n\n- Un valore di correlazione positivo indica che livelli più alti di supporto sociale (LSNS) sono associati a una maggiore soddisfazione della vita (SWLS).  \n- Se la correlazione è debole, il supporto sociale potrebbe non essere un predittore forte della soddisfazione della vita in questo campione ristretto.  \n:::\n\n::: {.callout-note collapse=true title=\"Informazioni sull'ambiente di sviluppo\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsessionInfo()\n#> R version 4.5.1 (2025-06-13)\n#> Platform: aarch64-apple-darwin20\n#> Running under: macOS Sequoia 15.6.1\n#> \n#> Matrix products: default\n#> BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib \n#> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1\n#> \n#> locale:\n#> [1] C/UTF-8/C/C/C/C\n#> \n#> time zone: Europe/Rome\n#> tzcode source: internal\n#> \n#> attached base packages:\n#> [1] stats     graphics  grDevices utils     datasets  methods   base     \n#> \n#> other attached packages:\n#>  [1] gridExtra_2.3         dslabs_0.8.0          ggbeeswarm_0.7.2     \n#>  [4] pillar_1.11.0         tinytable_0.13.0      patchwork_1.3.2      \n#>  [7] ggdist_3.3.3          tidybayes_3.0.7       bayesplot_1.14.0     \n#> [10] ggplot2_3.5.2         reliabilitydiag_0.2.1 priorsense_1.1.1     \n#> [13] posterior_1.6.1       loo_2.8.0             rstan_2.32.7         \n#> [16] StanHeaders_2.32.10   brms_2.22.0           Rcpp_1.1.0           \n#> [19] sessioninfo_1.2.3     conflicted_1.2.0      janitor_2.2.1        \n#> [22] matrixStats_1.5.0     modelr_0.1.11         tibble_3.3.0         \n#> [25] dplyr_1.1.4           tidyr_1.3.1           rio_1.2.3            \n#> [28] here_1.0.1           \n#> \n#> loaded via a namespace (and not attached):\n#>  [1] inline_0.3.21         sandwich_3.1-1        rlang_1.1.6          \n#>  [4] magrittr_2.0.3        multcomp_1.4-28       snakecase_0.11.1     \n#>  [7] compiler_4.5.1        systemfonts_1.2.3     vctrs_0.6.5          \n#> [10] stringr_1.5.1         pkgconfig_2.0.3       arrayhelpers_1.1-0   \n#> [13] fastmap_1.2.0         backports_1.5.0       labeling_0.4.3       \n#> [16] rmarkdown_2.29        ragg_1.5.0            purrr_1.1.0          \n#> [19] xfun_0.53             cachem_1.1.0          jsonlite_2.0.0       \n#> [22] broom_1.0.9           parallel_4.5.1        R6_2.6.1             \n#> [25] stringi_1.8.7         RColorBrewer_1.1-3    lubridate_1.9.4      \n#> [28] estimability_1.5.1    knitr_1.50            zoo_1.8-14           \n#> [31] pacman_0.5.1          Matrix_1.7-4          splines_4.5.1        \n#> [34] timechange_0.3.0      tidyselect_1.2.1      abind_1.4-8          \n#> [37] codetools_0.2-20      curl_7.0.0            pkgbuild_1.4.8       \n#> [40] lattice_0.22-7        withr_3.0.2           bridgesampling_1.1-2 \n#> [43] coda_0.19-4.1         evaluate_1.0.5        survival_3.8-3       \n#> [46] RcppParallel_5.1.11-1 tensorA_0.36.2.1      checkmate_2.3.3      \n#> [49] stats4_4.5.1          distributional_0.5.0  generics_0.1.4       \n#> [52] rprojroot_2.1.1       rstantools_2.5.0      scales_1.4.0         \n#> [55] xtable_1.8-4          glue_1.8.0            emmeans_1.11.2-8     \n#> [58] tools_4.5.1           mvtnorm_1.3-3         grid_4.5.1           \n#> [61] QuickJSR_1.8.0        colorspace_2.1-1      nlme_3.1-168         \n#> [64] beeswarm_0.4.0        vipor_0.4.7           cli_3.6.5            \n#> [67] textshaping_1.0.3     svUnit_1.0.8          Brobdingnag_1.2-9    \n#> [70] V8_7.0.0              gtable_0.3.6          digest_0.6.37        \n#> [73] TH.data_1.1-4         htmlwidgets_1.6.4     farver_2.1.2         \n#> [76] memoise_2.0.1         htmltools_0.5.8.1     lifecycle_1.0.4      \n#> [79] MASS_7.3-65\n```\n:::\n\n:::\n\n## Bibliografia {.unnumbered .unlisted}\n\n",
    "supporting": [
      "07_introduction_normal_distribution_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}