{
  "hash": "4d8bea9e538153fd52df4611b5b8469f",
  "result": {
    "engine": "knitr",
    "markdown": "# L'ambiente di programmazione {#sec-r-environment}\n\n## Introduzione {.unnumbered .unlisted}\n\nProgrammare presuppone necessariamente un ambiente di programmazione. Una cattiva gestione di questo ambiente può causare il malfunzionamento degli script, rendendo fondamentale imparare a gestirlo correttamente.\n\n> **Nota**: In R, il termine \"ambiente\" ha un significato specifico, riferendosi allo spazio di lavoro in cui gli oggetti vengono memorizzati durante una sessione. In questo capitolo, tuttavia, il termine si riferisce allo stato complessivo del tuo computer mentre programmi, inclusa l'organizzazione dei file, la versione di R che stai usando e altre impostazioni.\n\nL'ambiente può influenzare persino il comportamento delle funzioni più basilari. Considera il seguente esempio:\n\n```r\nprint(1:9)\n```\n\nQuesto potrebbe produrre il seguente output:\n\n```\n[1] 1 2 3 4 5 6 7 8 9\n```\n\nTuttavia, modificando l'opzione di larghezza in R, il comportamento cambia:\n\n```r\n# Dopo aver modificato options(width)\noptions(width = 10)\nprint(1:9)\n```\n\nIn questo caso, l'output potrebbe essere:\n\n```\n[1] 1 2 3\n[4] 4 5 6\n[7] 7 8 9\n```\n\nLa differenza è dovuta a un’opzione dell’ambiente, `width`, che regola il numero massimo di caratteri visualizzati per ogni riga. \n\n::: {.callout-tip collapse=true}\n## Prerequisiti\n\n- Leggere il capitolo 3, \"Setting Up Your Data Science Project\", del libro [Veridical Data Science](https://vdsbook.com) [@yu2024veridical].\n- Leggere il @sec-apx-shell della dispensa.\n:::\n\n::: {.callout-caution collapse=true title=\"Preparazione del Notebook\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhere::here(\"code\", \"_common.R\") |> \n  source()\n\n# Load packages\nif (!requireNamespace(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(tidyr)\n```\n:::\n\n:::\n\n\n## File system\n\nPrima di iniziare a organizzare un progetto in R, è fondamentale seguire alcune linee guida per strutturare e nominare i file in modo efficace. Spesso si tende a sottovalutare l'importanza di una buona organizzazione, ma adottare un sistema coerente può far risparmiare tempo prezioso nella ricerca e gestione dei progetti passati. Danielle Navarro ha creato una [presentazione](https://djnavarro.net/slides-project-structure/#1) sulla struttura dei progetti, nella quale propone tre principi fondamentali per la gestione dei file:\n\n- essere gentili con le macchine;\n- essere gentili con gli esseri umani;\n- facilitare l'ordinamento e la ricerca.\n\n### Essere gentili con le macchine\n\nLe macchine possono confondersi con spazi, caratteri speciali (come `^.*?+|$\"`), e lettere accentate. Per evitare problemi:\n\n- usa solo lettere minuscole, numeri, trattini `_` o `-`;\n- evita caratteri speciali e spazi nei nomi dei file;\n- evita le lettere accentate;\n- usa estensioni coerenti, come `.R` per gli script R.\n\nEsempi:\n\n```bash\n# Buono\nprogetto01_analisi_dati.R\n\n# Cattivo\nProgetto \"Analisi Dati\".R\n```\n\n### Essere gentili con gli umani\n\nGli esseri umani hanno bisogno di contesto. Evita nomi vaghi e usa descrizioni significative.\n\n```bash\n# Buono\nanalisi01_statistiche_descrittive.R\nnote02_intro_modello.docx\n\n# Cattivo\n01.R\nappunti.docx\n```\n\n::: {.callout-important}\nEvitate categoricamente l'uso di spazi nei nomi di file, cartelle o oggetti in R. Anche se il sistema operativo potrebbe consentirlo, questa pratica può generare problemi futuri, complicare il debugging e rendere il codice meno leggibile e portabile. Per evitare questi inconvenienti, adottate sempre nomi privi di spazi, preferendo separatori come trattini bassi (`_`) o trattini (`-`).\n:::\n\n### Facilitare l’ordinamento e la ricerca\n\nSe i nomi dei file includono date, usa sempre il formato `YYYY-MM-DD` per permettere un ordinamento automatico.\n\n```bash\n# Buono\n2024-01-01_analisi.R\n2024-02-15_riassunto.docx\n\n# Cattivo\n1-gennaio-2024.R\nriassunto-15-02-2024.docx\n```\n\nSe devi ordinare i file in base a qualcosa di diverso dalle date, usa numeri con lo zero iniziale per mantenere l’ordine.\n\n```bash\nreading01_shakespeare_romeo-and-juliet.docx\nreading02_shakespeare_romeo-and-juliet.docx\n...\nreading11_shakespeare_romeo-and-juliet.docx\nnotes01_shakespeare_romeo-and-juliet.docx\n...\n```\n\n## Versioni di R e pacchetti\n\nAggiornare regolarmente R e i pacchetti è essenziale per evitare bug e sfruttare le nuove funzionalità. Ecco alcune buone pratiche:\n\n1. Esegui `update.packages()` ogni poche settimane per aggiornare i pacchetti.\n2. Aggiorna la versione di R ogni pochi mesi. Su Windows puoi usare il pacchetto `installr`, mentre su altri sistemi puoi scaricare l'ultima versione dal sito ufficiale di R.\n3. Mantieni aggiornato anche il sistema operativo.\n\n## Progetti in R\n\nSe hai seguito i consigli finora, avrai creato una cartella per tutti i tuoi progetti di programmazione e la tua installazione di R sarà aggiornata. Ora è il momento di organizzare i tuoi progetti in R.\n\n### Percorsi assoluti e relativi\n\nUn percorso assoluto parte dalla directory principale del tuo computer (ad esempio, `/` su Linux/MacOS o `C:/` su Windows) e indica in modo completo e univoco la posizione di un file o di una cartella. Un percorso relativo, invece, parte dalla directory corrente del progetto o dalla directory di lavoro impostata e descrive la posizione di un file in relazione a questa.\n\nAd esempio, il percorso assoluto del file utilizzato per generare questa pagina HTML potrebbe essere ottenuto così:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfs::path_abs(\"05_environment.qmd\")\n#> /Users/corrado/_repositories/utet-eda/chapters/R/05_environment.qmd\n```\n:::\n\n\n## Funzione `here()`\n\nSe il progetto si trova nella cartella `psicometria-r`, possiamo utilizzare la funzione `here()` del pacchetto **here** per indicare la posizione del file `05_environment.qmd` in modo relativo. Ecco un esempio:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfile.exists(here::here(\"chapters\", \"R\", \"07_environment.qmd\"))\n#> [1] TRUE\n```\n:::\n\n\nIn questo caso, il file `07_environment.qmd` è contenuto nella cartella `chapters/R`, che si trova all'interno della directory principale del progetto. Grazie a `here()`, non è necessario specificare manualmente la posizione del progetto: questa funzione identifica automaticamente la directory principale e consente di indicare solo il percorso relativo del file rispetto ad essa. In altre parole, puoi riferirti al file `07_environment.qmd` semplicemente fornendo il percorso relativo all'interno della struttura del progetto, lasciando a `here()` il compito di gestire il contesto globale. \n\n### Perché preferire i percorsi relativi?\n\nL’utilizzo di percorsi relativi con `here()` offre numerosi vantaggi:\n\n1. **Portabilità**: Il codice diventa più semplice da condividere, poiché non dipende dalla struttura delle directory specifica del computer su cui è stato scritto.\n2. **Organizzazione**: Favorisce una struttura chiara e coerente all’interno del progetto, rendendo più facile individuare e accedere ai file.\n3. **Affidabilità**: Riduce il rischio di errori dovuti a percorsi assoluti errati, soprattutto quando il progetto viene spostato o condiviso.\n\n### Buone pratiche\n\n- **Usare sempre percorsi relativi**: Questo assicura che il progetto sia facilmente eseguibile su altri sistemi senza necessità di modifiche ai percorsi.\n- **Impostare una struttura coerente del progetto**: Organizzare i file in cartelle ben definite (ad esempio, `data`, `scripts`, `outputs`) facilita l’uso di percorsi relativi.\n\nIn sintesi, specificare i percorsi relativi rispetto alla directory principale del progetto è una buona pratica essenziale per garantire portabilità, organizzazione e riproducibilità del lavoro.\n\n### Creare un progetto in R\n\nUn progetto R è semplicemente una cartella con un file `.Rproj`. Puoi crearne uno con RStudio o con il pacchetto `usethis`.\n\n**In RStudio**:\n\n1. Vai su `File > New Project`.\n2. Seleziona `New Directory > New Project`.\n3. Dai un nome al progetto e scegli la sua posizione.\n\n**Con `usethis`**:\n\n```r\nusethis::create_project(\"path/alla/cartella\")\n```\n\nEsempio:\n\n```r\nusethis::create_project(\"/Users/corrado/_repositories/psicometria-r\")\n```\n\nVedremo nel @sec-eda-proj-structure come organizzare i file all'interno di un progetto.\n\n\n::: {.callout-note collapse=true title=\"Informazioni sull'ambiente di sviluppo\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsessionInfo()\n#> R version 4.5.1 (2025-06-13)\n#> Platform: aarch64-apple-darwin20\n#> Running under: macOS Sequoia 15.6.1\n#> \n#> Matrix products: default\n#> BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib \n#> LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1\n#> \n#> locale:\n#> [1] C/UTF-8/C/C/C/C\n#> \n#> time zone: Europe/Rome\n#> tzcode source: internal\n#> \n#> attached base packages:\n#> [1] stats     graphics  grDevices utils     datasets  methods   base     \n#> \n#> other attached packages:\n#>  [1] pillar_1.11.0         tinytable_0.13.0      patchwork_1.3.2      \n#>  [4] ggdist_3.3.3          tidybayes_3.0.7       bayesplot_1.14.0     \n#>  [7] ggplot2_3.5.2         reliabilitydiag_0.2.1 priorsense_1.1.1     \n#> [10] posterior_1.6.1       loo_2.8.0             rstan_2.32.7         \n#> [13] StanHeaders_2.32.10   brms_2.22.0           Rcpp_1.1.0           \n#> [16] sessioninfo_1.2.3     conflicted_1.2.0      janitor_2.2.1        \n#> [19] matrixStats_1.5.0     modelr_0.1.11         tibble_3.3.0         \n#> [22] dplyr_1.1.4           tidyr_1.3.1           rio_1.2.3            \n#> [25] here_1.0.1           \n#> \n#> loaded via a namespace (and not attached):\n#>  [1] svUnit_1.0.8          tidyselect_1.2.1      farver_2.1.2         \n#>  [4] fastmap_1.2.0         TH.data_1.1-4         tensorA_0.36.2.1     \n#>  [7] pacman_0.5.1          digest_0.6.37         timechange_0.3.0     \n#> [10] estimability_1.5.1    lifecycle_1.0.4       survival_3.8-3       \n#> [13] magrittr_2.0.3        compiler_4.5.1        rlang_1.1.6          \n#> [16] tools_4.5.1           knitr_1.50            bridgesampling_1.1-2 \n#> [19] htmlwidgets_1.6.4     curl_7.0.0            pkgbuild_1.4.8       \n#> [22] RColorBrewer_1.1-3    abind_1.4-8           multcomp_1.4-28      \n#> [25] withr_3.0.2           purrr_1.1.0           grid_4.5.1           \n#> [28] stats4_4.5.1          colorspace_2.1-1      xtable_1.8-4         \n#> [31] inline_0.3.21         emmeans_1.11.2-8      scales_1.4.0         \n#> [34] MASS_7.3-65           cli_3.6.5             mvtnorm_1.3-3        \n#> [37] crayon_1.5.3          rmarkdown_2.29        ragg_1.5.0           \n#> [40] generics_0.1.4        RcppParallel_5.1.11-1 cachem_1.1.0         \n#> [43] stringr_1.5.1         splines_4.5.1         parallel_4.5.1       \n#> [46] vctrs_0.6.5           V8_7.0.0              Matrix_1.7-4         \n#> [49] sandwich_3.1-1        jsonlite_2.0.0        arrayhelpers_1.1-0   \n#> [52] systemfonts_1.2.3     glue_1.8.0            codetools_0.2-20     \n#> [55] distributional_0.5.0  lubridate_1.9.4       stringi_1.8.7        \n#> [58] gtable_0.3.6          QuickJSR_1.8.0        htmltools_0.5.8.1    \n#> [61] Brobdingnag_1.2-9     R6_2.6.1              textshaping_1.0.3    \n#> [64] rprojroot_2.1.1       evaluate_1.0.5        lattice_0.22-7       \n#> [67] backports_1.5.0       memoise_2.0.1         broom_1.0.9          \n#> [70] snakecase_0.11.1      rstantools_2.5.0      coda_0.19-4.1        \n#> [73] gridExtra_2.3         nlme_3.1-168          checkmate_2.3.3      \n#> [76] xfun_0.53             fs_1.6.6              zoo_1.8-14           \n#> [79] pkgconfig_2.0.3\n```\n:::\n\n:::\n\n## Bibliografia {.unnumbered .unlisted}\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}